(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r,n;r=jQuery,n={init:function(){r("#vendor-delivery-time-date-picker").on("change",n.set_delivery_time_date_picker)},init_dashboard_calendar:function(){if("undefined"!=typeof FullCalendar){var e=document.getElementById("delivery-time-calendar");new FullCalendar.Calendar(e,{firstDay:dokan_helper.week_starts_day,defaultView:"dayGridMonth",datesRender:function(e){console.log("viewType:",e.view.calendar.state.viewType)},defaultDate:new Date,headerToolbar:{start:"dayGridMonth,timeGridWeek,timeGridDay,listWeek",center:"title",end:"today prev,next"},events:function(e,t,r){var a={action:"dokan_get_dashboard_calendar_event",start_date:moment(e.start).format("YYYY-MM-DD"),end_date:moment(e.end).format("YYYY-MM-DD"),nonce:dokan_delivery_time_calendar_nonce},d=n.get_filter_query_param("delivery_type_filter");d&&(a.type_filter=d),jQuery.post(dokan.ajaxurl,a,(function(e){e.success&&e.data.calendar_events&&t(Array.prototype.slice.call(e.data.calendar_events))}))},eventDidMount:function(e){r(e.el).tooltip({title:e.event.extendedProps.info.body,placement:"top",trigger:"hover",container:"body",animation:!0,html:!0})}}).render()}},set_delivery_time_date_picker:function(){var e=r("#vendor-delivery-time-date-picker"),t=e.data("vendor_id"),a=e.data("nonce"),d=e.attr("value");d?r("#vendor-delivery-time-date-picker").fadeIn(400):r("#vendor-delivery-time-date-picker").fadeOut(400);var i={action:"dokan_get_delivery_time_slot",vendor_id:t,nonce:a,date:d};i.date&&n.get_delivery_time_slots(i)},set_order_details_delivery_calendar_config:function(){if("undefined"!=typeof vendorInfo){var e=vendorInfo,r={minDate:"today",altInput:!0,altFormat:dokan_get_i18n_date_format(!1),dateFormat:"Y-m-d",disable:[]},n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],a=Object.keys(e.vendor_delivery_options.delivery_day),d=[];n.forEach((function(e){a.includes(e)||d.push(n.indexOf(e))}));var i=e.vendor_vacation_days,o=e.vendor_preorder_blocked_dates;r.disable=[function(e){return d.includes(e.getDay())}],r.disable=[].concat(t(r.disable),t(i),t(o)),flatpickr("#vendor-delivery-time-date-picker",r)}},get_delivery_time_slots:function(e){r("#vendor-delivery-time-slot-picker").prop("disabled",!0),jQuery.post(dokan.ajaxurl,e,(function(e){e.success&&(r("#vendor-delivery-time-slot-picker option:gt(0)").remove(),r.each(e.data.vendor_delivery_slots,(function(e,t){r("#vendor-delivery-time-slot-picker").append(r("<option></option>").attr("value",e).text(e))})),r("#vendor-delivery-time-slot-picker").prop("disabled",!1))}))},get_filter_query_param:function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.search);return null!==t&&(t[1]||0)}},jQuery(document).ready((function(e){n.init(),n.set_order_details_delivery_calendar_config(),n.init_dashboard_calendar()}))})();