(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function t(t,o){if(t){if("string"==typeof t)return e(t,o);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,o):void 0}}function o(o){return function(t){if(Array.isArray(t))return e(t)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||t(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,o){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var r,n,a=[],i=!0,d=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){d=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(d)throw n}}return a}}(e,o)||t(e,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n,a,i;n=jQuery,a={init:function(){n(".delivery-time-slot-picker").hide(),n(".store-pickup-select-options .store-address").hide(),n(".delivery-time-date-picker").on("change",a.delivery_type_selector_handler),a.init_calendar()},delivery_type_selector_handler:function(e){e.preventDefault();var t=n(e.target),o=t.data("vendor_id"),r={vendor_id:o,nonce:t.data("nonce"),selected_date:t.attr("value")};a.get_delivery_time_slots(r),a.get_store_pickup_locations(r),"delivery"===n("#dokan-selected-delivery-type-".concat(o)).val()&&n("#delivery-store-location-picker-".concat(o)).hide()},get_store_pickup_locations:function(e){var t={action:"dokan_store_location_get_items",vendor_id:e.vendor_id,nonce:e.nonce};e.selected_date?(n("#delivery-store-location-picker-".concat(e.vendor_id)).fadeIn(400),n("#dokan-spinner-overlay").fadeIn(100),jQuery.post(dokan.ajaxurl,t,(function(e){e.success&&(n("#dokan-spinner-overlay").fadeOut(400),n("#delivery-store-location-picker-".concat(t.vendor_id," option:gt(0)")).remove(),n.each(e.data.vendor_store_locations,(function(e,o){var r=i.get_store_location_info_from_formatted_string(o).name;n("#delivery-store-location-picker-".concat(t.vendor_id)).append(n("<option></option>").attr("value",o).text(r))})))}))):n("#delivery-store-location-picker-".concat(e.vendor_id)).fadeOut(400)},get_delivery_time_slots:function(e){e.selected_date?n("#delivery-time-slot-picker-".concat(e.vendor_id)).fadeIn(400):n("#delivery-time-slot-picker-".concat(e.vendor_id)).fadeOut(400),n("#delivery-time-slot-picker-".concat(e.vendor_id)).val(n("#delivery-time-slot-picker-".concat(e.vendor_id," option:first")).val());var t={action:"dokan_get_delivery_time_slot",vendor_id:e.vendor_id,nonce:e.nonce,date:e.selected_date};t.date&&a.get_delivery_time_slots_data(t)},get_delivery_time_slots_data:function(e){n("#dokan-spinner-overlay").fadeIn(100),jQuery.post(dokan.ajaxurl,e,(function(t){t.success&&(n("#dokan-spinner-overlay").fadeOut(400),n("#delivery-time-slot-picker-".concat(e.vendor_id," option:gt(0)")).remove(),n.each(t.data.vendor_delivery_slots,(function(t,o){n("#delivery-time-slot-picker-".concat(e.vendor_id)).append(n("<option></option>").attr("value",t).text(t))})))}))},init_calendar:function(){if("undefined"!=typeof dokan_delivery_time_vendor_infos)for(var e=dokan_delivery_time_vendor_infos,t={minDate:"today",altInput:!0,altFormat:dokan_get_i18n_date_format(!1),dateFormat:"Y-m-d",disable:[]},n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],a=function(){var e=r(d[i],2),a=e[0],c=e[1],l=Object.keys(c.vendor_delivery_options.delivery_day),s=[];n.forEach((function(e){l.includes(e)||s.push(n.indexOf(e))}));var v=c.vendor_vacation_days,_=c.vendor_preorder_blocked_dates;t.disable=[function(e){return s.includes(e.getDay())}],t.disable=[].concat(o(t.disable),o(v),o(_)),flatpickr("#delivery-time-date-picker-"+a,t)},i=0,d=Object.entries(e);i<d.length;i++)a()}},i={init:function(){n(".dokan-store-location-selector").length&&this.trigger_store_location_pickup()},trigger_store_location_pickup:function(){n(".dokan-store-location-selector .selector-wrapper .selector").on("click",(function(e){var t=n(this).data("selector"),o=n(this).data("vendor_id"),r=n("#dokan-delivery-selector-".concat(o)),a=n("#dokan-store-pickup-selector-".concat(o)),i=n("#dokan-selected-delivery-type-".concat(o));n("#dokan-spinner-overlay").fadeIn(100),a.removeClass("active-selector"),r.removeClass("active-selector"),n(this).hasClass("active-selector")||(n(this).addClass("active-selector"),n("#dokan-spinner-overlay").fadeOut(400)),i.val(t),"delivery"===t?(n("#delivery-store-location-picker-".concat(o)).fadeOut(),n("#delivery-store-location-address-".concat(o)).parent().fadeOut()):"store-pickup"===t&&(n("#delivery-store-location-picker-".concat(o)).fadeIn(),n("#delivery-store-location-picker-".concat(o)).val()&&n("#delivery-store-location-address-".concat(o)).parent().fadeIn())})),n(".delivery-store-location-picker").on("change",(function(e){var t=n(this).data("vendor_id"),o=n("#delivery-store-location-address-".concat(t)),r=i.get_store_location_info_from_formatted_string(this.value).address;o.parent().fadeIn(),o.html(r)}))},get_store_location_info_from_formatted_string:function(e){return e?{name:e.split("(")[0],address:e.match(/\((.*?)\)/)[1]}:{name:"",address:""}}},jQuery(document).ready((function(e){i.init(),a.init()}))})();