(()=>{"use strict";function t(r){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(r)}var r,n,e,a;!function(r){function n(t,r,n){return t===r?t=r:t===n&&(t=n),t}function e(t){return void 0!==t}function a(t,r,n){var e=n/100*(r-t);return 1===(e=Math.round(t+e).toString(16)).length&&(e="0"+e),e}function i(t,r,n){if(!t||!r)return null;n=e(n)?n:0,t=f(t),r=f(r);var i=a(t.r,r.r,n),o=a(t.b,r.b,n);return"#"+i+a(t.g,r.g,n)+o}function o(t,a){function s(t){e(t)||(t=a.rating),N=t;var r=t/O,n=r*R;r>1&&(n+=(Math.ceil(r)-1)*U),g(a.ratedFill),B.css("width",n+"%")}function l(){Y=P*a.numStars+T*(a.numStars-1),R=P/Y*100,U=T/Y*100,t.width(Y),s()}function c(r){var n=a.starWidth=r;return P=window.parseFloat(a.starWidth.replace("px","")),Q.find("svg").attr({width:a.starWidth,height:n}),B.find("svg").attr({width:a.starWidth,height:n}),l(),t}function p(r){return a.spacing=r,T=parseFloat(a.spacing.replace("px","")),Q.find("svg:not(:first-child)").css({"margin-left":r}),B.find("svg:not(:first-child)").css({"margin-left":r}),l(),t}function f(r){return a.normalFill=r,Q.find("svg").attr({fill:a.normalFill}),t}function g(r){if(a.multiColor){var n=(N-D)/a.maxValue*100,e=a.multiColor||{};r=i(e.startColor||d.startColor,e.endColor||d.endColor,n)}else $=r;return a.ratedFill=r,B.find("svg").attr({fill:a.ratedFill}),t}function h(t){a.multiColor=t,g(t||$)}function v(n){a.numStars=n,O=a.maxValue/a.numStars,Q.empty(),B.empty();for(var e=0;e<a.numStars;e++)Q.append(r(u)),B.append(r(u));return c(a.starWidth),f(a.normalFill),p(a.spacing),s(),t}function m(r){return a.maxValue=r,O=a.maxValue/a.numStars,a.rating>r&&S(r),s(),t}function y(r){return a.precision=r,S(a.rating),t}function w(r){return a.halfStar=r,t}function b(r){return a.fullStar=r,t}function k(t){var r=Q.offset().left,n=r+Q.width(),e=a.maxValue,i=t.pageX,o=0;if(r>i)o=D;else if(i>n)o=e;else{var s=(i-r)/(n-r);if(T>0)for(var l=s*=100;l>0;)l>R?(o+=O,l-=R+U):(o+=l/R*O,l=0);else o=s*a.maxValue;o=function(t){var r=t%O,n=O/2,e=a.halfStar,i=a.fullStar;return i||e?(i||e&&r>n?t+=O-r:(t-=r,r>0&&(t+=n)),t):t}(o)}return o}function x(r){return a.readOnly=r,t.attr("readonly",!0),A(),r||(t.removeAttr("readonly"),t.on("mousemove",j).on("mouseenter",j).on("mouseleave",I).on("click",V).on("rateyo.init",E).on("rateyo.change",q).on("rateyo.set",W)),t}function S(r){var e=r,i=a.maxValue;return"string"==typeof e&&("%"===e[e.length-1]&&(e=e.substr(0,e.length-1),m(i=100)),e=parseFloat(e)),function(t,r,n){if(!(t>=r&&n>=t))throw Error("Invalid Rating, expected value between "+r+" and "+n)}(e,D,i),e=parseFloat(e.toFixed(a.precision)),n(parseFloat(e),D,i),a.rating=e,s(),X&&t.trigger("rateyo.set",{rating:e}),t}function C(r){return a.onInit=r,t}function F(r){return a.onSet=r,t}function _(r){return a.onChange=r,t}function j(r){var e=k(r).toFixed(a.precision),i=a.maxValue;s(e=n(parseFloat(e),D,i)),t.trigger("rateyo.change",{rating:e})}function I(){s(),t.trigger("rateyo.change",{rating:a.rating})}function V(t){var r=k(t).toFixed(a.precision);r=parseFloat(r),M.rating(r)}function E(t,r){a.onInit&&"function"==typeof a.onInit&&a.onInit.apply(this,[r.rating,M])}function q(t,r){a.onChange&&"function"==typeof a.onChange&&a.onChange.apply(this,[r.rating,M])}function W(t,r){a.onSet&&"function"==typeof a.onSet&&a.onSet.apply(this,[r.rating,M])}function A(){t.off("mousemove",j).off("mouseenter",j).off("mouseleave",I).off("click",V).off("rateyo.init",E).off("rateyo.change",q).off("rateyo.set",W)}this.node=t.get(0);var M=this;t.empty().addClass("jq-ry-container");var O,P,R,T,U,Y,z=r("<div/>").addClass("jq-ry-group-wrapper").appendTo(t),Q=r("<div/>").addClass("jq-ry-normal-group").addClass("jq-ry-group").appendTo(z),B=r("<div/>").addClass("jq-ry-rated-group").addClass("jq-ry-group").appendTo(z),D=0,N=a.rating,X=!1,$=a.ratedFill;this.rating=function(r){return e(r)?(S(r),t):a.rating},this.destroy=function(){return a.readOnly||A(),o.prototype.collection=function(t,n){return r.each(n,(function(r){if(t===this.node){var e=n.slice(0,r),a=n.slice(r+1,n.length);return n=e.concat(a),!1}})),n}(t.get(0),this.collection),t.removeClass("jq-ry-container").children().remove(),t},this.method=function(t){if(!t)throw Error("Method name not specified!");if(!e(this[t]))throw Error("Method "+t+" doesn't exist!");var r=Array.prototype.slice.apply(arguments,[]),n=r.slice(1),a=this[t];return a.apply(this,n)},this.option=function(t,r){if(!e(t))return a;var n;switch(t){case"starWidth":n=c;break;case"numStars":n=v;break;case"normalFill":n=f;break;case"ratedFill":n=g;break;case"multiColor":n=h;break;case"maxValue":n=m;break;case"precision":n=y;break;case"rating":n=S;break;case"halfStar":n=w;break;case"fullStar":n=b;break;case"readOnly":n=x;break;case"spacing":n=p;break;case"onInit":n=C;break;case"onSet":n=F;break;case"onChange":n=_;break;default:throw Error("No such option as "+t)}return e(r)?n(r):a[t]},v(a.numStars),x(a.readOnly),this.collection.push(this),this.rating(a.rating,!0),X=!0,t.trigger("rateyo.init",{rating:a.rating})}function s(t,n){var e;return r.each(n,(function(){return t===this.node?(e=this,!1):void 0})),e}function l(n){var e=o.prototype.collection,a=r(this);if(0===a.length)return a;var i=Array.prototype.slice.apply(arguments,[]);if(0===i.length)n=i[0]={};else{if(1!==i.length||"object"!=t(i[0])){if(i.length>=1&&"string"==typeof i[0]){var l=i[0],u=i.slice(1),d=[];return r.each(a,(function(t,r){var n=s(r,e);if(!n)throw Error("Trying to set options before even initialization");var a=n[l];if(!a)throw Error("Method "+l+" does not exist!");var i=a.apply(n,u);d.push(i)})),d=1===d.length?d[0]:d}throw Error("Invalid Arguments")}n=i[0]}return n=r.extend({},c,n),r.each(a,(function(){return s(this,e)?void 0:new o(r(this),r.extend({},n))}))}var u='<?xml version="1.0" encoding="utf-8"?><svg version="1.1"xmlns="http://www.w3.org/2000/svg"viewBox="0 12.705 512 486.59"x="0px" y="0px"xml:space="preserve"><polygon points="256.814,12.705 317.205,198.566 512.631,198.566 354.529,313.435 414.918,499.295 256.814,384.427 98.713,499.295 159.102,313.435 1,198.566 196.426,198.566 "/></svg>',c={starWidth:"32px",normalFill:"gray",ratedFill:"#f39c12",numStars:5,maxValue:5,precision:1,rating:0,fullStar:!1,halfStar:!1,readOnly:!1,spacing:"0px",multiColor:null,onInit:null,onChange:null,onSet:null},d={startColor:"#c0392b",endColor:"#f1c40f"},p=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,f=function(t){if(!p.test(t))return null;var r=p.exec(t);return{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}};o.prototype.collection=[],window.RateYo=o,r.fn.rateYo=function(){return l.apply(this,Array.prototype.slice.apply(arguments,[]))}}(window.jQuery),r=jQuery,n=r(".dokan-review-wrapper"),e="dokan_store_rating_ajax_handler",a={init:function(){n.on("click","button.add-review-btn",this.popUp.show),n.on("click","button.edit-review-btn",this.popUp.showEdit),r("body").on("submit","#dokan-add-review-form",this.popUp.submitReview)},popUp:{show:function(t){var n={action:e,data:"review_form",store_id:r("button.add-review-btn").data("store_id")};r.post(dokan.ajaxurl,n,(function(t){1==t.success?r.magnificPopup.open({items:{src:'<div class="white-popup dokan-seller-rating-add-wrapper"><div id="ds-error-msg" ></div>'+t.data+"</div>",type:"inline"}}):alert("failed")}))},showEdit:function(t){var n={action:e,data:"edit_review_form",store_id:r("button.edit-review-btn").data("store_id"),post_id:r("button.edit-review-btn").data("post_id")};r.post(dokan.ajaxurl,n,(function(t){1==t.success?r.magnificPopup.open({items:{src:'<div class="white-popup dokan-seller-rating-add-wrapper"><div id="ds-error-msg" ></div>'+t.data+"</div>",type:"inline"}}):alert("failed")}))},submitReview:function(t){t.preventDefault();var n=r(this),a={action:e,data:"submit_review",store_id:r("button.add-review-btn").data("store_id"),rating:r("#dokan-seller-rating").rateYo("rating"),form_data:n.serialize()},i=r("#ds-error-msg");r.post(dokan.ajaxurl,a,(function(t){1==t.success?(r.magnificPopup.close(),r.magnificPopup.open({items:{src:'<div class="white-popup dokan-seller-rating-add-wrapper dokan-alert dokan-alert-success">'+t.msg+"</div>",type:"inline"}}),location.reload()):0==t.success?(i.removeClass("dokan-hide"),i.html(t.msg),i.addClass("dokan-alert dokan-alert-danger")):alert("failed")}))}}},r((function(){a.init()}))})();