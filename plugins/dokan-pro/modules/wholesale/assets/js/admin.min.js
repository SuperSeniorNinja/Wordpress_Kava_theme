(()=>{"use strict";var e=function(e,t,s,o,a,n,r,i){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=s,u._compiled=!0),o&&(u.functional=!0),n&&(u._scopeId="data-v-"+n),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},u._ssrRegister=l):a&&(l=i?function(){a.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}({name:"WholesaleCustomer",components:{ListTable:dokan_get_lib("ListTable"),Switches:dokan_get_lib("Switches"),Search:dokan_get_lib("Search"),AdminNotice:dokan_get_lib("AdminNotice")},data:function(){return{showCb:!0,counts:{deactive:0,active:0,all:0},totalItems:0,perPage:20,totalPages:1,loading:!1,columns:{full_name:{label:this.__("Name","dokan")},email:{label:this.__("E-mail","dokan")},username:{label:this.__("Username","dokan")},role:{label:this.__("Roles","dokan")},registered:{label:this.__("Registered","dokan"),sortable:!0},wholesale_status:{label:this.__("Status","dokan")}},actionColumn:"full_name",actions:[{key:"edit",label:this.__("Edit","dokan")},{key:"orders",label:this.__("Orders","dokan")},{key:"delete",label:this.__("Remove","dokan")}],bulkActions:[{key:"activate",label:this.__("Active","dokan")},{key:"deactivate",label:this.__("Deactive","dokan")}],customers:[]}},watch:{"$route.query.status":function(){this.fetchWholesaleCustomers()},"$route.query.page":function(){this.fetchWholesaleCustomers()},"$route.query.orderby":function(){this.fetchWholesaleCustomers()},"$route.query.order":function(){this.fetchWholesaleCustomers()}},computed:{currentStatus:function(){return this.$route.query.status||"all"},currentPage:function(){var e=this.$route.query.page||1;return parseInt(e)},sortBy:function(){return this.$route.query.orderby||"registered"},sortOrder:function(){return this.$route.query.order||"desc"}},created:function(){this.fetchWholesaleCustomers()},methods:{getFullName:function(e){return e.first_name+" "+e.last_name},doSearch:function(e){var t=this,s=this;s.loading=!0,dokan.api.get("/wholesale/customers/?search=".concat(e),{page:this.currentPage,orderby:this.sortBy,order:this.sortOrder}).done((function(e,o,a){s.customers=e,s.loading=!1,t.updatePagination(a)}))},updatedCounts:function(e){this.counts.deactive=parseInt(e.getResponseHeader("X-Status-Deactive")),this.counts.active=parseInt(e.getResponseHeader("X-Status-Active")),this.counts.all=parseInt(e.getResponseHeader("X-Status-All"))},updatePagination:function(e){this.totalPages=parseInt(e.getResponseHeader("X-WP-TotalPages")),this.totalItems=parseInt(e.getResponseHeader("X-WP-Total"))},fetchWholesaleCustomers:function(){var e=this,t=this;t.loading=!0,dokan.api.get("/wholesale/customers",{per_page:this.perPage,page:this.currentPage,status:this.currentStatus,orderby:this.sortBy,order:this.sortOrder}).done((function(s,o,a){t.customers=s,t.loading=!1,e.updatedCounts(a),e.updatePagination(a)}))},onActionClick:function(e,t){var s=this;"delete"===e&&confirm("Are you sure to delete?")&&dokan.api.put("/wholesale/customer/"+t.id,{status:"delete"}).done((function(e){s.$notify({title:s.__("Success!","dokan"),type:"success",text:s.__("Successfully removed from wholesale customer lists","dokan")}),s.fetchWholesaleCustomers()}))},onSwitch:function(e,t){var s=this,o=!1===e?this.__("The customer has been disabled for wholesale.","dokan"):this.__("Wholesale capability activate","dokan");dokan.api.put("/wholesale/customer/"+t,{status:!1===e?"deactivate":"activate"}).done((function(e){s.$notify({title:s.__("Success!","dokan"),type:"success",text:o}),s.fetchWholesaleCustomers()}))},moment:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return moment(e)})),goToPage:function(e){this.$router.push({name:"WholesaleCustomer",query:{status:this.currentStatus,page:e}})},onBulkAction:function(e,t){var s=this,o={};o[e]=t,this.loading=!0,dokan.api.put("/wholesale/customers/batch",o).done((function(e){s.bulkLocal=-1,s.checkedItems=[],s.loading=!1,s.fetchWholesaleCustomers()}))},sortCallback:function(e,t){this.$router.push({name:"WholesaleCustomer",query:{status:this.currentStatus,page:1,orderby:e,order:t}})},ordersUrl:function(e){return dokan.urls.adminRoot+"edit.php?post_type=shop_order&_customer_user="+e},editUrl:function(e){return dokan.urls.adminRoot+"user-edit.php?user_id="+e}}},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wholesale-customer-list"},[s("h1",{staticClass:"wp-heading-inline"},[e._v(e._s(e.__("Wholesale Customers","dokan")))]),e._v(" "),s("AdminNotice"),e._v(" "),s("hr",{staticClass:"wp-header-end"}),e._v(" "),s("ul",{staticClass:"subsubsub"},[s("li",[s("router-link",{attrs:{to:{name:"WholesaleCustomer",query:{status:"all"}},"active-class":"current",exact:""},domProps:{innerHTML:e._s(e.sprintf(e.__("All <span class='count'>(%s)</span>","dokan"),e.counts.all))}}),e._v(" | ")],1),e._v(" "),s("li",[s("router-link",{attrs:{to:{name:"WholesaleCustomer",query:{status:"active"}},"active-class":"current",exact:""},domProps:{innerHTML:e._s(e.sprintf(e.__("Active <span class='count'>(%s)</span>","dokan"),e.counts.active))}}),e._v(" | ")],1),e._v(" "),s("li",[s("router-link",{attrs:{to:{name:"WholesaleCustomer",query:{status:"deactive"}},"active-class":"current",exact:""},domProps:{innerHTML:e._s(e.sprintf(e.__("Deactive <span class='count'>(%s)</span>","dokan"),e.counts.deactive))}})],1)]),e._v(" "),s("search",{attrs:{title:"Search Customer"},on:{searched:e.doSearch}}),e._v(" "),s("list-table",{attrs:{columns:e.columns,loading:e.loading,rows:e.customers,actions:e.actions,actionColumn:"full_name","show-cb":e.showCb,"total-items":e.totalItems,"bulk-actions":e.bulkActions,"total-pages":e.totalPages,"per-page":e.perPage,"current-page":e.currentPage,"action-column":e.actionColumn,text:e.$root.listTableTexts(),"not-found":"No customers found.","sort-by":e.sortBy,"sort-order":e.sortOrder},on:{sort:e.sortCallback,pagination:e.goToPage,"bulk:click":e.onBulkAction,searched:e.doSearch},scopedSlots:e._u([{key:"full_name",fn:function(t){return[s("img",{attrs:{src:t.row.avatar,alt:e.getFullName(t.row),width:"50"}}),e._v(" "),s("strong",[s("a",{attrs:{href:e.editUrl(t.row.id)}},[e._v(e._s(e.getFullName(t.row)?e.getFullName(t.row):e.__("(no name)","dokan")))])])]}},{key:"email",fn:function(t){return[s("a",{attrs:{href:"mailto:"+t.row.email}},[e._v(e._s(t.row.email))])]}},{key:"registered",fn:function(t){return[e._v("\n            "+e._s(e.moment(t.row.registered).format("MMM D, YYYY"))+"\n        ")]}},{key:"wholesale_status",fn:function(t){return[s("switches",{attrs:{enabled:"active"==t.row.wholesale_status,value:t.row.id},on:{input:e.onSwitch}})]}},{key:"row-actions",fn:function(t){return e._l(e.actions,(function(o,a){return s("span",{class:o.key},["edit"==o.key?s("a",{attrs:{href:e.editUrl(t.row.id)}},[e._v(e._s(o.label))]):"orders"==o.key?s("a",{attrs:{href:e.ordersUrl(t.row.id)}},[e._v(e._s(o.label))]):s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.onActionClick(o.key,t.row)}}},[e._v(e._s(o.label))]),e._v(" "),a!==e.actions.length-1?[e._v(" | ")]:e._e()],2)}))}}])})],1)}),[],!1,null,null,null);const t=e.exports;dokan_add_route(t)})();